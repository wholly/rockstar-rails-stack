# $Id: Portfile 49869 2009-04-19 11:59:30Z jeremyhu@macports.org $

PortSystem          1.0

name                xterm
version             243
categories          x11
platforms           darwin
maintainers         jeremyhu openmaintainer
description         the ubiquitous X terminal emulator, stand-alone
long_description    The xterm program is a terminal emulator for the X \
                    Window System. It supports a plethora of features, \
                    including colors, Unicode, etc.

homepage            http://invisible-island.net/xterm/
master_sites        ftp://invisible-island.net/xterm/
checksums           md5     be25d2d3661d0bb77fc66e1bcbb3caba \
                    sha1    2d21f9ac13df846053b43d9fcf6ae70eaa63715a \
                    rmd160  0099382feb4c6b97fb37fa77edebfb6903a38835
extract.suffix      .tgz

depends_build \
	port:xorg-xproto

depends_run \
	bin:luit:luit

depends_lib \
	port:ncurses \
	port:expat \
	port:zlib \
	port:xorg-libXaw \
	port:Xft2

patchfiles          xterm-243b.patch

configure.args      --mandir=${prefix}/share/man --enable-luit \
                    --enable-logging --enable-wide-chars \
                    --enable-256-color --enable-load-vt-fonts

# AC_X_PATH blindly asks xmkmf where X11 is, and it always uses /usr/X11R6.
# This block helps us link correctly and setup our pc files correctly when we   
# are +system_x11 and x11prefix is somewhere non-standard and should cause
# AC_X_PATH to let us setup our CPPFLAGS and LDFLAGS without interference
configure.args-append --x-include=${prefix}/include --x-lib=${prefix}/lib
if { ![file exists ${prefix}/lib/pkgconfig/x11.pc] } {
    pre-configure {
        configure.cppflags-append -I${x11prefix}/include
        configure.ldflags-append  -L${x11prefix}/lib
    }
}

# If -ltermcap stays in the LDFLAGS, xterm is linked against both
# /usr/lib's and ${prefix}/lib's libncurses.
post-configure {
    reinplace "s|-ltermcap|-lncurses|" ${worksrcpath}/Makefile
}

livecheck.check     regex
livecheck.url       ${master_sites}
livecheck.regex     "${name}\\.tar\\.gz -> ${name}-(\\d+)\\.tgz"

variant utmp description {Support updating utmp/utmpx database
                          (installs setgid daemon)} {
   configure.args-append   --with-utmp-setgid=daemon --with-utempter
}
