# $Id: Portfile 46002 2009-01-27 03:55:28Z blb@macports.org $
PortSystem 1.0
name        ddclient
version     3.7.3
platforms   darwin
categories  net
maintainers nomaintainer
description Update dynamic DNS entries
long_description    ddclient is a Perl client used to update dynamic \
            DNS entries for accounts on many dynamic DNS services.
homepage    http://ddclient.sourceforge.net/
master_sites    sourceforge:ddclient
checksums   md5     5459ae165e74437587b6e84225a7fbf0 \
            sha1    aa4368a58e5b344bffd6561fc7fed304c007fe84 \
            rmd160  df40a809132102b9326fa7e9d735723e1de8ed37
depends_run path:bin/perl:perl5

configure   {
        reinplace "s|\[\r\]$||" ${worksrcpath}/${name}
        reinplace "s|^#!.*/perl.*$|#!${prefix}/bin/perl|" ${worksrcpath}/${name}
        reinplace "s|/etc/|${prefix}/etc/|" ${worksrcpath}/${name}
}

build   {}

pre-destroot {
        file mkdir ${destroot}${prefix}/etc/ddclient
}

destroot    {
        xinstall -m 555 ${worksrcpath}/sample-etc_ddclient.conf \
            ${destroot}${prefix}/etc/ddclient/ddclient.conf.sample

        reinplace "s|/var/run|${prefix}/var/run|" \
            ${destroot}${prefix}/etc/ddclient/ddclient.conf.sample

        xinstall -m 555 ${worksrcpath}/${name} ${destroot}${prefix}/sbin
        xinstall -d ${destroot}${prefix}/share/doc/${name}

        eval file copy [glob ${worksrcpath}/sample-*] \
            ${destroot}${prefix}/share/doc/${name}
        eval file copy [glob ${worksrcpath}/COPY*] \
            ${destroot}${prefix}/share/doc/${name}
        eval file copy [glob ${worksrcpath}/README*] \
            ${destroot}${prefix}/share/doc/${name}

        destroot.keepdirs ${destroot}${prefix}/var/run
}

startupitem.create      yes
startupitem.start       ${prefix}/sbin/ddclient
startupitem.stop        "/bin/kill \$(cat ${prefix}/var/run/ddclient.pid)"


