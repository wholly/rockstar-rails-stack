# -*- coding: utf-8; mode: tcl; tab-width: 4; indent-tabs-mode: nil; c-basic-offset: 4 -*- vim:fenc=utf-8:ft=tcl:et:sw=4:ts=4:sts=4
# $Id: Portfile 49648 2009-04-14 15:11:57Z rowue@macports.org $

PortSystem          1.0

name                psi
version             0.12.1
categories          net chat
maintainers         rowue@macports.org
description         jabber-based instant messaging client
long_description \
    Psi is a capable Jabber client aimed at experienced users.  Its design \
    goals are simplicity and stability.

platforms           darwin

homepage            http://psi.affinix.com/
master_sites        sourceforge
use_bzip2           yes

checksums           md5     da273e45daef04ffc8338708e96e9173 \
                    sha1    6fdcea3a072b40333faecc37acdb925f9bf8c5c3 \
                    rmd160  a5fc850796b0078bc1a03f4ff93a03611ee11e80

depends_lib         lib:libz:zlib \
                    port:qt4-mac


configure.args      --qtdir=${prefix}/libexec/qt4-mac

destroot {
    xinstall -m 755 -d ${destroot}/Applications/MacPorts
    file copy ${worksrcpath}/src/psi.app ${destroot}/Applications/MacPorts
    system "strip \
        ${destroot}/Applications/MacPorts/psi.app/Contents/MacOS/psi"
}

variant externalqca description {Use external qca} {

configure.args-append   --disable-bundled-qca
depends_lib-append      port:qca-ossl \
                        port:qca-gnupg \
                        port:qca
}


variant ipv6 description {Add ipv6 support} { 

patchfiles-append      patch-src-src.pro.diff 
}


variant plugins description {Build with experimental Plugin Support} {

patchfiles-append       patch-configure.diff \
                        patch-src-about.ui.diff \
                        patch-src-main.cpp.diff \
                        patch-src-main.h.diff \
                        patch-src-options-opt_plugins.cpp.diff \
                        patch-src-options-opt_plugins.h.diff \
                        patch-src-pluginmanager.cpp.diff \
                        patch-src-pluginmanager.h.diff \
                        patch-src-psiaccount.cpp.diff \
                        patch-src-psichatdlg.cpp.diff \
                        patch-src-psichatdlg.h.diff \
                        patch-src-psiplugin.h.diff

configure.args-append   --enable-plugins
}
