# $Id: Portfile 30197 2007-10-22 20:52:33Z jmpp@macports.org $

PortSystem 1.0
name			iphone-openssl
version			0.9.7m
revision		1
platforms		darwin
categories		iphone
maintainers		landonf@macports.org openmaintainer
homepage		http://www.openssl.org/
description		OpenSSL headers and link libraries for iPhone cross-compilation.
long_description	${description}.

master_sites		http://www.openssl.org/source/
distname		openssl-${version}
checksums		md5 74a4d1b87e1e6e1ec95dbe58cb4c5b9a \
			sha1 546f6bcebdf72a633bad087469d3741a42f7b383 \
			rmd160 fed13325d90ae4749d7ee858931d6925c3955614
patchfiles		patch-Makefile.org \
			patch-Configure

depends_lib		port:iphone-zlib
depends_build		port:arm-apple-darwin-runtime \
			port:arm-apple-darwin-cc

set iphone_prefix ${prefix}/arm-apple-darwin

configure.cmd		./Configure darwin-arm-cc
configure.pre_args	--prefix=${iphone_prefix}
configure.args		--openssldir=${iphone_prefix}/etc/ssl \
			zlib no-asm no-krb5 shared


build.env		PATH=${iphone_prefix}/bin:$env(PATH)

destroot.violate_mtree  yes
destroot.destdir	INSTALL_PREFIX=${destroot}
# do not install docs, just sw
destroot.target		install_sw

test.run		yes

livecheck.check	regex
livecheck.url	${master_sites}
livecheck.regex	openssl-(0.9.7\[a-z\])
