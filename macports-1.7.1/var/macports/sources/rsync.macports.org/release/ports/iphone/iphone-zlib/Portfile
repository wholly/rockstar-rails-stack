# $Id: Portfile 30197 2007-10-22 20:52:33Z jmpp@macports.org $

PortSystem 1.0
name		iphone-zlib
version		1.2.3
revision	2
categories	iphone cross
maintainers	landonf@macports.org openmaintainer
description	ZLib headers and link libraries for iPhone cross-compiliation.

long_description ${description}.

homepage	http://www.zlib.net/
platforms	darwin

distname	zlib-${version}
master_sites	${homepage} \
		http://www.gzip.org/zlib/ \
		sourceforge:libpng

use_bzip2	yes
checksums	md5 dee233bf288ee795ac96a98cc2e369b6 \
		sha1 967e280f284d02284b0cd8872a8e2e04bfdc7283 \
		rmd160 cfba9984b354dcc38da49331457e6bfc861c6f51

patchfiles	patch-Makefile-static \
		patch-configure

depends_lib	port:arm-apple-darwin-runtime
depends_build	port:arm-apple-darwin-cc

set iphone_prefix ${prefix}/arm-apple-darwin

configure.env	PATH=${iphone_prefix}/bin:$env(PATH) CC=cc CFLAGS="-dynamiclib"
configure.args	--shared --prefix=${iphone_prefix}/arm-iphone

build.env	PATH=${iphone_prefix}/bin:$env(PATH)
build.target	libz.${version}.dylib

destroot.violate_mtree	yes
destroot.destdir prefix=${destroot}/${iphone_prefix}

livecheck.check regex
livecheck.url   ${homepage}
livecheck.regex "${name}-(\\\\d+(?:\\\\.\\\\d+)*)\\\\.tar\\\\.bz2"
