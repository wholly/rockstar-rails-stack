# $Id: Portfile 37973 2008-07-01 11:32:24Z mww@macports.org $

PortSystem      1.0

name            xemacs
version         21.4.21
revision	1
set sumo_date   2007-04-27
categories      editors x11
platforms       darwin
maintainers     mww
description     A highly customizable open source text editor.

long_description \
    XEmacs is a highly customizable open source text editor and application development \
    system. It is protected under the GNU Public License and related to other versions of \
    Emacs, in particular GNU Emacs.

homepage        http://www.xemacs.org
master_sites    http://ftp.xemacs.org/pub/xemacs/xemacs-21.4/:xemacs \
                ftp://ftp.xemacs.org/pub/xemacs/xemacs-21.4/:xemacs \
                http://ftp.xemacs.org/pub/xemacs/packages/:package \
                ftp://ftp.xemacs.org/pub/xemacs/packages/:package \
                http://mirrors.ibiblio.org/pub/mirrors/xemacs/packages/:package

use_bzip2       yes
set xemacs_dist ${name}-${version}${extract.suffix}
set sumo_dist   ${name}-sumo-${sumo_date}${extract.suffix}
set mule_dist   ${name}-mule-sumo-${sumo_date}${extract.suffix}

distfiles       ${xemacs_dist}:xemacs ${sumo_dist}:package ${mule_dist}:package

checksums       ${xemacs_dist} \
                    md5 1669330c839780791242fed788ef5482 \
                    sha1 1c75232615b064c69b5d442052a97c0fa22a49b2 \
                    rmd160 a22c27b68247ccbd6ab79c103ada7c3aecccc9d4 \
                ${sumo_dist} \
                    md5 735fd204c1939f76704b7ba770f59b8c \
                    sha1 e094fcd1b0cc2b409bfdca828ac5603da3c4e0e4 \
                    rmd160 b4480601a49fbd708691f3f95204e8f0443fc2aa \
                ${mule_dist} \
                    md5 47107fc32d61773568c623d22c29bd0b \
                    sha1 f817078a1b1fc26bf38219ba167e22c2c00869fe \
                    rmd160 cacc52b81e6482681297bf03379df75851b3ea80

configure.args  --mandir=${prefix}/share/man \
                --without-postgresql \
                --without-ldap \
                --with-sound=none \
                --pdump \
                --site-prefixes=${prefix} \
                --with-tty \
                --with-dialogs=athena \
                --with-widgets=athena \
                --with-athena=3d \
                --with-database=gdbm \
                --with-mule

depends_lib     port:libpng port:Xaw3d port:ncurses port:gdbm port:jpeg \
                port:tiff port:compface port:gettext port:zlib

destroot.args   prefix=${destroot}${prefix} mandir=${destroot}${prefix}/share/man/man1

destroot.keepdirs ${destroot}${prefix}/lib/xemacs
post-destroot {
    set xemacs_lib ${destroot}${prefix}/lib/xemacs-${version}
    xinstall -d -m 0555 ${xemacs_lib}
    system "cd ${destroot}${prefix}/lib && ln -s xemacs-${version} xemacs"
    if {[file exists ${workpath}/mule-packages]} {
        ui_debug "Installing mule-sumo distribution into destroot"
        file copy ${workpath}/mule-packages ${xemacs_lib}/
    }
    if {[file exists ${workpath}/xemacs-packages]} {
        ui_debug "Installing sumo distribution into destroot"
        file copy ${workpath}/xemacs-packages ${xemacs_lib}
    }
}

variant no_sumo \
    description "do not install sumo and mule" {
    configure.args-delete --with-mule
    depends_lib-delete    port:gettext
    distfiles-delete      ${sumo_dist}:package ${mule_dist}:package
}

