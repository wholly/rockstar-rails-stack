# -*- coding: utf-8; mode: tcl; tab-width: 4; indent-tabs-mode: nil; c-basic-offset: 4 -*- vim:fenc=utf-8:filetype=tcl:et:sw=4:ts=4:sts=4
# $Id: Portfile 41645 2008-11-08 04:01:55Z nox@macports.org $

PortSystem      1.0

name            cedet-devel
set my_name     cedet
version         1.0pre4
categories      editors
platforms       darwin
maintainers     nox openmaintainer
description     Infrastructure for parser based text analysis in Emacs

long_description \
    Semantic is an infrastructure for parser based text analysis in Emacs. \
    It is a lexer, parser-generator, and parser. It is written in Emacs \
    Lisp and is customized to the way Emacs thinks about language files, \
    and is optimized to use Emacs' parsing capabilities.

homepage        http://cedet.sourceforge.net/
master_sites    sourceforge:$my_name
distname        $my_name-$version

checksums       md5     fdc22624ae284166d9617acdc6ecbfda \
                sha1    586bc98f881cdd8e5d97d61b9c82a115f251a461 \
                rmd160  db09e6b5ae6bf3f9a357b4baf85447bd1ce80437

depends_build   port:emacs

depends_run     port:emacs

use_configure   no

use_parallel_build  yes

destroot {
    set lispdir $prefix/share/emacs/site-lisp

    set packages {
        common
        ede
        speedbar
        eieio
        semantic
        cogre
        contrib
    }

    proc destroot_package package_dir {
        global  destroot worksrcpath
        upvar   lispdir lispdir

        xinstall -d $destroot$lispdir/$package_dir
        foreach f [glob -directory $worksrcpath/$package_dir *] {
            if {[file isdirectory $f]} {
                set p [file tail $f]

                if {$p ne "." && $p ne ".."} {
                    destroot_package $package_dir/$p
                }
            } else {
                set ext [file extension $f]

                if {$ext eq ".el" || $ext eq ".elc"} {
                    xinstall -m 644 $f $destroot$lispdir/$package_dir
                }
            }
        }
    }

    foreach p $packages {
        destroot_package $p
    }
}

universal_variant   no
