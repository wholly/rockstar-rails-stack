# -*- coding: utf-8; mode: tcl; tab-width: 4; indent-tabs-mode: nil; c-basic-offset: 4 -*- vim:fenc=utf-8:ft=tcl:et:sw=4:ts=4:sts=4
# $Id: Portfile 48776 2009-03-28 18:49:23Z rowue@macports.org $

PortSystem      1.0

name                qucs
version             0.0.14
revision            7
categories          science electronics
maintainers         rowue@macports.org
platforms           darwin
description         an integrated circuit simulator
long_description    Qucs is an integrated circuit simulator. \
    You can setup an circut with graphical user interface. \
    It's based on QT
homepage            http://qucs.sourceforge.net/
master_sites        sourceforge
checksums           md5 6c2b7ec626ccb167eb089c322d21aed0 \
                    sha1 2563657d3659e1c7d45399f0c10dbc9fe4850b04 \
                    rmd160 3962ca9e893f828d7e1bb033815f07e651c83e49
depends_lib         port:qt3-mac \
                    port:freehdl \
                    port:libtool \
                    port:iverilog \
                    port:asco
use_parallel_build  yes
patchfiles          patch-configure.diff \
                    patch-qucs-main.cpp.diff \
                    patch-qucs-main.h.diff \
                    patch-qucs-qucs_actions.cpp.diff \
                    patch-qucs_qucsdigi.diff \
                    patch-qucs_qucsveri.diff


post-patch {
        reinplace "s|@APPDIR@|${applications_dir}|g" ${worksrcpath}/qucs/main.cpp
        reinplace "s|@PREFIX@|${prefix}|g" ${worksrcpath}/qucs/qucsdigi
        reinplace "s|@PREFIX@|${prefix}|g" ${worksrcpath}/qucs/qucsveri
}

post-destroot {
    foreach Program {qucs qucsedit qucsfilter qucshelp qucslib qucstrans qucsattenuator} {
        xinstall -m 755 -d ${destroot}${applications_dir}/${Program}.app/Contents/MacOS
        move ${destroot}${prefix}/bin/${Program} ${destroot}${applications_dir}/${Program}.app/Contents/MacOS/
        xinstall -m 755 -d ${destroot}${applications_dir}/${Program}.app/Contents/Resources
        xinstall -m 0644 ${filespath}/${Program}.icns ${destroot}${applications_dir}/${Program}.app/Contents/Resources
        xinstall -m 0644 ${filespath}/Info.plist ${destroot}${applications_dir}/${Program}.app/Contents/
        reinplace "s|@VERSION@|${version}|" ${destroot}${applications_dir}/${Program}.app/Contents/Info.plist
        reinplace "s|@EXECUTABLE@|${Program}|" ${destroot}${applications_dir}/${Program}.app/Contents/Info.plist
        system "echo 'APPL????' > ${destroot}${applications_dir}/${Program}.app/Contents/PkgInfo"
    }
}

