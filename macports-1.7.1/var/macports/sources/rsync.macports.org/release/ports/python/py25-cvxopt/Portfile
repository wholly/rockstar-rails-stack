# $Id: Portfile 41154 2008-10-26 03:04:43Z jmr@macports.org $

PortSystem         1.0
PortGroup          python25 1.0

categories-append  math
name               py25-cvxopt
version            1.1
distname           cvxopt-${version}
maintainers        cornell.edu:ajb78
platforms          darwin

description        Python module for convex optimization 
long_description   CVXOPT is a free software package for convex optimization \
based on the Python programming language. It can be used with the interactive \
Python interpreter, on the command line by executing Python scripts, or \
integrated in other software via Python extension modules. Its main purpose is \
to make the development of software for convex optimization applications \
straightforward by building on Python's extensive standard library and on the \
strengths of Python as a high-level programming language.

homepage           http://abel.ee.ucla.edu/cvxopt

distfiles          cvxopt-${version}.tar.gz.gtar
master_sites       http://abel.ee.ucla.edu/download.php

checksums          md5 c56def864966a4e168474bb1c00f5808 \
                   sha1 693bc10293ebe1ff59d7115e45d7e72f6262e548 \
                   rmd160 33e2e047429df21662d3875d385b15ff9c334d52

depends_lib-append port:atlas

variant gsl description {Allow linking to gsl} {
  depends_lib-append port:gsl
}

variant fftw description {Link to fftw library} {
  depends_lib-append port:fftw-3
}

variant glpk description {Link to glpk library} {
  depends_lib-append port:glpk
}

default_variants +gsl +glpk +fftw

configure {
    reinplace "s|ATLAS_LIB_DIR = .*|ATLAS_LIB_DIR = '${prefix}/lib'|" \
              ${worksrcpath}/src/setup.py

    if {[variant_isset gsl]} {
        reinplace "s|BUILD_GSL = .*|BUILD_GSL = 1|" \
              ${worksrcpath}/src/setup.py
        reinplace "s|GSL_LIB_DIR = .*|GSL_LIB_DIR = '${prefix}/lib'|" \
              ${worksrcpath}/src/setup.py
        reinplace "s|GSL_INC_DIR = .*|GSL_INC_DIR = '${prefix}/include'|" \
              ${worksrcpath}/src/setup.py
    }
    if {[variant_isset glpk]} {
        reinplace "s|BUILD_GLPK = .*|BUILD_GLPK = 1|" \
              ${worksrcpath}/src/setup.py
        reinplace "s|GLPK_LIB_DIR = .*|GLPK_LIB_DIR = '${prefix}/lib'|" \
              ${worksrcpath}/src/setup.py
        reinplace "s|GLPK_INC_DIR = .*|GLPK_INC_DIR = '${prefix}/include'|" \
              ${worksrcpath}/src/setup.py
    }
    if {[variant_isset fftw]} {
        reinplace "s|BUILD_FFTW = .*|BUILD_FFTW = 1|" \
              ${worksrcpath}/src/setup.py
        reinplace "s|FFTW_LIB_DIR = .*|FFTW_LIB_DIR = '${prefix}/lib'|" \
              ${worksrcpath}/src/setup.py
        reinplace "s|FFTW_INC_DIR = .*|FFTW_INC_DIR = '${prefix}/include'|" \
              ${worksrcpath}/src/setup.py
    }
}

build.dir ${worksrcpath}/src

destroot.dir ${build.dir}
