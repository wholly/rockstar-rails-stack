# $Id: Portfile 49706 2009-04-15 17:41:14Z jann@macports.org $

PortSystem      1.0

name            spin
version         5.1.7
set version_no_dot [join [split ${version} .] ""]
distname        ${name}${version_no_dot}
categories      devel
platforms       darwin
maintainers     jann@macports.org
description     The Spin model checker

long_description \
    SPIN is a general tool for verifying the correctness of \
    distributed software (software design) in a rigorous and \
    mostly automated fashion.

homepage        http://spinroot.com
master_sites    http://spinroot.com/spin/Src/
checksums       rmd160  e7065ffe54f468b4717c4df7752a20bc9cae907a
depends_lib     port:tk port:tcl
patchfiles      patch-makefile.diff \
                patch-xspin.diff
worksrcdir      Spin/Src${version}
use_configure   no

set xspin_dir   Xspin5.1
set xspin_name  xspin510.tcl

pre-patch   {
    file rename ${worksrcpath}/../${xspin_dir}/${xspin_name} ${worksrcpath}/../${xspin_dir}/xspin
}

post-patch  {
    reinplace "s,@prefix@,${prefix},g" ${worksrcpath}/../${xspin_dir}/xspin
}

build.target    ""

destroot    {
    xinstall -m 0444 ${worksrcpath}/../Man/${name}.1 \
        ${destroot}${prefix}/share/man/man1
    xinstall -m 0755 ${worksrcpath}/${name} \
        ${destroot}${prefix}/bin
    xinstall -m 0755 ${worksrcpath}/../${xspin_dir}/xspin \
        ${destroot}${prefix}/bin
}
