# $Id: Portfile 47549 2009-03-01 00:38:06Z jeremyhu@macports.org $

PortSystem 1.0
name		gtkglext
version		1.2.0
revision        3
categories	devel
maintainers	jd@lifehertz.com
description	OpenGL Extension to GTK
platforms	macosx darwin
long_description	\
		${description}

homepage	http://sourceforge.net/projects/gtkglext/
master_sites	sourceforge

checksums	md5 5c3240bfc1b21becd33ce35c5abe6f8d

depends_lib \
	port:mesa \
	port:xorg-libXmu \
	port:gtk2

# AC_X_PATH blindly asks xmkmf where X11 is, and it always uses /usr/X11R6.
# This block helps us link correctly and setup our pc files correctly when we   
# are +system_x11 and x11prefix is somewhere non-standard and should cause
# AC_X_PATH to let us setup our CPPFLAGS and LDFLAGS without interference
configure.args-append --x-include=${prefix}/include --x-lib=${prefix}/lib
if { ![file exists ${prefix}/lib/pkgconfig/x11.pc] } {
    pre-configure {
        configure.cppflags-append -I${x11prefix}/include
        configure.ldflags-append  -L${x11prefix}/lib
    }

    # And this will similarly get ports that use pkgconfig to find our pkgconfig-less libX11
    post-destroot {
        if {![file exists ${x11prefix}/lib/pkgconfig/x11.pc]} {
            foreach pc [glob ${destroot}${prefix}/lib/pkgconfig/*.pc] {
                reinplace "s:-lXt:-L${prefix}/lib -L${x11prefix}/lib -lXt:g" ${pc}
            }
        }
    }
}
