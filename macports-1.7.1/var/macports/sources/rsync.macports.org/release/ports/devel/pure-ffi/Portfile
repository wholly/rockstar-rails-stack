# $Id: Portfile 49472 2009-04-10 16:46:48Z ryandesign@macports.org $

PortSystem                      1.0

name                            pure-ffi
version                         0.5
revision                        1
categories                      devel
platforms                       darwin
maintainers                     ryandesign
use_parallel_build              yes
homepage                        http://pure-lang.googlecode.com/
master_sites                    ${homepage}files/

description                     an interface to libffi which enables you to \
                                call C functions from Pure and vice versa

long_description                ${name} provides ${description}. It goes \
                                beyond Pure's built-in C interface in that \
                                it also handles C structs and makes Pure \
                                functions callable from C. Moreover, \
                                depending on the libffi implementation, it \
                                may also be possible to call foreign \
                                languages other than C.

checksums                       md5     ad840dac7dd73ae9a068ff95e6d525a3 \
                                sha1    69252f50151e2a2649b12e55678060457294e991 \
                                rmd160  b3db049b2a2456381eed7f8505e952f534f8ac65

depends_lib-append              path:lib/libpure.dylib:pure \
                                port:libffi

use_configure                   no

pre-build {
    build.args-append           CC=${configure.cc} \
                                CFLAGS="${configure.cflags}" \
                                CPPFLAGS="${configure.cppflags}" \
                                LDFLAGS="${configure.ldflags}"
}

post-destroot {
    xinstall -d \
        ${destroot}${prefix}/share/doc/${name} \
        ${destroot}${prefix}/share/examples
    xinstall -m 644 -W ${worksrcpath} \
        COPYING \
        README \
        ${destroot}${prefix}/share/doc/${name}
    copy ${worksrcpath}/examples ${destroot}${prefix}/share/examples/${name}
}

platform darwin {
    configure.cflags-append     -fno-common
}

livecheck.check                 regex
livecheck.url                   http://code.google.com/p/pure-lang/downloads/list
livecheck.regex                 ${name}-(\[0-9.\]+)\\.tar
