# $Id: Portfile 47145 2009-02-22 20:09:36Z raimue@macports.org $

PortSystem 1.0

name			metis
version			4.0
revision                1
categories		math
platforms		darwin
maintainers		nomaintainer
description		A package for unstructured graph partitioning
long_description	\
METIS is a set of programs for partitioning graphs and for producing fill \
reducing orderings for sparse matrices. The algorithms implemented by METIS \
are based on the multilevel graph partitioning scheme described in \[KK95a\] \
and \[KK95e\]. METIS provides high quality partitions, is extremely fast, and \
produces low fill orderings.

homepage		http://www-users.cs.umn.edu/~karypis/metis/metis/
master_sites		http://glaros.dtc.umn.edu/gkhome/fetch/sw/metis/ freebsd
checksums		sha1 580568308e1fa40e5a7a77cacbf27f865d6c01af

build.target

configure.cmd   true
post-configure {
	# ensure that the correct compiler is used
	reinplace "s|CC = .*|CC = ${configure.cc}|" ${worksrcpath}/Makefile.in
}

destroot {
	xinstall -m 755 -d ${destroot}${prefix}/include/metis \
		${destroot}${prefix}/share/doc/${name}
	xinstall -m 755 -W ${worksrcpath} graphchk kmetis mesh2dual mesh2nodal \
		oemetis onmetis partdmesh partnmesh pmetis ${destroot}${prefix}/bin
	xinstall -W ${worksrcpath}/Lib defs.h macros.h metis.h proto.h rename.h \
		struct.h ${destroot}${prefix}/include/metis
	reinplace "s,#include <defs.h>,#include <metis/defs.h>," ${destroot}${prefix}/include/metis/metis.h
	reinplace "s,#include <struct.h>,#include <metis/struct.h>," ${destroot}${prefix}/include/metis/metis.h
	reinplace "s,#include <macros.h>,#include <metis/macros.h>," ${destroot}${prefix}/include/metis/metis.h
	reinplace "s,#include <rename.h>,#include <metis/rename.h>," ${destroot}${prefix}/include/metis/metis.h
	reinplace "s,#include <proto.h>,#include <metis/proto.h>," ${destroot}${prefix}/include/metis/metis.h
	xinstall -m 644 ${worksrcpath}/libmetis.a ${destroot}${prefix}/lib
	xinstall -m 644 ${worksrcpath}/Doc/manual.ps \
		${destroot}${prefix}/share/doc/${name}
}

livecheck.check regex
livecheck.url   http://glaros.dtc.umn.edu/gkhome/metis/metis/download
livecheck.regex {metis-([0-9.]+)\.tar\.gz}
