# $Id: Portfile 42650 2008-11-28 03:35:24Z blair@macports.org $

PortSystem 1.0

name			derby
version			10.4.2.0

categories		java
maintainers		blair
platforms		darwin

description		Relational database implemented entirely in Java
long_description	Apache Derby, an Apache DB subproject, is an open \
			source relational database implemented entirely in \
			Java and available under the Apache License, Version \
			2.0.  Some key advantages include:  1) Derby has a \
			small footprint -- about 2 megabytes for the base \
			engine and embedded JDBC driver.  2) Derby is based \
			on the Java, JDBC, and SQL standards.  3) Derby \
			provides an embedded JDBC driver that lets you \
			embed Derby in any Java-based solution.  4) Derby \
			also supports the more familiar client/server mode \
			with the Derby Network Client JDBC driver and Derby \
			Network Server.  5) Derby is easy to install, deploy, \
			and use.
homepage		http://db.apache.org/derby/

master_sites		apache:db/derby/db-${name}-${version}
distname		db-${name}-${version}-bin
checksums		md5 ee9e0619c492a12fcc321d0675b44aec \
			sha1 3a5af3c1f09cdb55bcd78e92dc26c8a1fd937b63 \
			rmd160 9a7c8775af4b50e944dc9819bcdd7ca061eb3292

depends_lib		bin:java:kaffe

use_configure		no

build.cmd		true

destroot {
	# Ensure needed directories
	xinstall -m 755 -d ${destroot}${prefix}/share \
		${destroot}${prefix}/share/doc/${name}

	foreach f { dblook derby_common.sh ij sysinfo } {
		file copy ${worksrcpath}/bin/$f ${destroot}${prefix}/bin
	}

	foreach f { KEYS LICENSE NOTICE RELEASE-NOTES.html } {
		file copy ${worksrcpath}/$f \
			${destroot}${prefix}/share/doc/${name}
	}

	file copy ${worksrcpath}/lib ${destroot}${prefix}/share/java
}

variant doc description {Install HTML and PDF documentation and javadocs} {
	post-destroot {
		foreach f { docs javadoc } {
			file copy ${worksrcpath}/$f \
				${destroot}${prefix}/share/doc/${name}
		}
	}
}

livecheck.check		regex
livecheck.url		"http://db.apache.org/derby/releases/?C=N;O=D"
livecheck.regex		release-(\[0-9.\]+)\.html
