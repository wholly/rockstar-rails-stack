# $Id: Portfile 48316 2009-03-19 03:42:02Z jeremyhu@macports.org $

PortSystem      1.0

name            TeXShop
version         2.26
categories      aqua editors
PortGroup       xcode 1.0

maintainers     waqar@macports.org
description     TeX previewer for Mac OS X
long_description   \
    TeXShop is a TeX previewer for Mac OS X, written in Cocoa.  \
    Since pdf is a native file format on OS X, TeXShop uses     \
    "pdftex" and "pdflatex" rather than "tex" and "latex" to    \
    typeset, these programs in the standard teTeX distribution  \
    of TeX produce pdf output instead of dvi output.
homepage        http://www.uoregon.edu/~koch/texshop/texshop.html
platforms       macosx
master_sites    http://www.uoregon.edu/~koch/texshop
use_zip         yes
distname        texshopsource-${version}
dist_subdir     ${name}/${version}
worksrcdir      texshop${version}
checksums           md5     75b10928a8dff68f67f318322b6a2880 \
                    sha1    bed5704c284b8dcf4542b15a950f1abd097da97a \
                    rmd160  9649f662ceccc8ce8337ef6952df5029f240a574

platform darwin 7 {
pre-fetch {
return -code error "\n
    TeXShop 2.x will not install on less than OS X 10.4 and there isn't a
    TeXShop 1.x port contributed as yet to accommodate 10.3.\n"
}
}

post-extract	{
	reinplace "s/defaultConfigurationName = Debug/defaultConfigurationName = Release/" ${worksrcpath}/${name}.xcodeproj/project.pbxproj
}

use_configure   no
build.type      pbx
build.target    ${name}

xcode.project		${name}.xcodeproj
xcode.configuration	Release
xcode.build.settings    FRAMEWORK_SEARCH_PATHS=${worksrcpath} \
			CONFIGURATION_BUILD_DIR=${worksrcpath}/build

destroot        {
	system "cd ${worksrcpath} && ${build.cmd} DSTROOT=${destroot}  \
        INSTALL_PATH=/Applications/MacPorts -target ${name} install    \
        INSTALL_MODE_FLAG=755 ${xcode.build.settings}"

    file delete -force ${destroot}/Applications/MacPorts/TeX.mdimporter
}
