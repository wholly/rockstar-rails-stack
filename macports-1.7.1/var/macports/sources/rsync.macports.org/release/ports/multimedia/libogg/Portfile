# $Id: Portfile 39226 2008-08-12 21:28:43Z ryandesign@macports.org $

PortSystem      1.0

name            libogg
version         1.1.3
revision        2
categories      multimedia
platforms       darwin
use_parallel_build  yes
maintainers     nox openmaintainer
description     Ogg Bitstream Library

long_description \
    Libogg is a library for manipulating ogg bitstreams. It handles both \
    making ogg bitstreams and getting packets from ogg bitstreams.

homepage        http://www.vorbis.com/
master_sites    http://downloads.xiph.org/releases/ogg/

checksums       md5 eaf7dc6ebbff30975de7527a80831585 \
                sha1 a3e495a8baf6939efad7e0bd11cc0e466838c3db \
                rmd160 2dc0ab120416441a007cf1017f461372eab03c0d

post-patch {
    reinplace "s/__MACOSX__/__APPLE__/" ${worksrcpath}/include/ogg/os_types.h
}

post-configure {
    if {[variant_isset universal]} {
        reinplace "s|CC -dynamiclib|CC -dynamiclib ${configure.universal_ldflags}|g" \
            ${worksrcpath}/libtool
    }

    if {! [variant_isset doc]} {
        reinplace -E "/^install:/s/install-recursive//" \
            ${worksrcpath}/doc/Makefile
    }
}

pre-destroot {
    # Fix parallel build for MacPorts < 1.7.0
    xinstall -d ${destroot}${prefix}/include/ogg
}

post-destroot {
    set docdir ${prefix}/share/doc/${name}-${version}
    if {! [variant_isset doc]} {
        xinstall -d ${destroot}${docdir}
    }
    xinstall -m 0644 -W ${worksrcpath} AUTHORS CHANGES COPYING README ${destroot}${docdir}
}

variant doc description {Install extra documentation} {}

