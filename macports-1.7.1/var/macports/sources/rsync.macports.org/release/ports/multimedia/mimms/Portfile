# $Id: Portfile 44243 2008-12-23 21:57:26Z mcalhoun@macports.org $

PortSystem 1.0

name            mimms
version         2.0.1
revision        1
categories      multimedia
maintainers     boeyms openmaintainer
description     MiMMS isn't an MMS Message Sender, it's an MMS \
                (e.g. mms://) stream downloader.
long_description \
    MiMMS is a program designed to allow you to download streams using the MMS \
    protocol and save them to your computer, as opposed to watching them live. \
    Similar functionality is available in full media player suites such as \
    Xine and MPlayer, but MiMMS is quick and easy to use, and for the time \
    being, remains a useful program.
homepage        http://savannah.nongnu.org/projects/mimms/
platforms       darwin
master_sites    http://download.savannah.gnu.org/releases/mimms/
checksums       md5     3e44f5b182892c4adfa8c08ddf8ccc17 \
                sha1    197f4c89c74d40a7aec382d20160a746946ce795 \
                rmd160  a23430022371c530e91b7991f52275e545f61e3d
use_bzip2       yes
patchfiles      patch-mimms.cpp.diff patch-mimms.pro.diff
depends_lib     port:libmms
pre-fetch {
    if {![variant_isset qt4] && ![variant_isset qt4_mac]} {
        return -code error "
###########################################################
# mimms will not compile unless one of the +qt4 or +qt4_mac
# variants are selected.  Please choose one of these variants to build.
###########################################################"
    }
}

set qt_dir  ${prefix}/libexec/qt4-mac

configure {
    reinplace "s|@prefix@|${prefix}|g" ${worksrcpath}/mimms.pro
}
build.env       CPPFLAGS="-I${prefix}/include -I${prefix}/include/libmms" \
                CFLAGS=-O2 \
                LDFLAGS=-L${prefix}/lib
build.args-append   PREFIX=${prefix} QMAKE=${qt_dir}/bin/qmake
destroot.destdir-append   PREFIX=${prefix}

variant qt4 conflicts qt4_mac description {Links MiMMS against the qt4 port} {
    patchfiles-append   patch-Makefile.qt4.diff
    depends_lib-append  port:qt4
}

variant qt4_mac conflicts qt4 description {Links MiMMS against the qt4-mac port} {
    patchfiles-append   patch-Makefile.qt4-mac.diff
    depends_lib-append  port:qt4-mac
}
