# $Id: Portfile 48539 2009-03-24 19:35:09Z rmsfisher@macports.org $

PortSystem      1.0

name            p7zip
version         4.65
categories      archivers
maintainers     simon openmaintainer
platforms       darwin
description     7-Zip implementation

long_description \
    p7zip is a port of 7-Zip, a file archiver with \
    highest compression ratio.

homepage        http://p7zip.sourceforge.net/

master_sites    sourceforge
distname        [strsed ${distname} {g/-/_/}]
use_bzip2       yes
distfiles       ${distname}_src_all${extract.suffix}

checksums           md5     f78ed232436dc8f8be25a2f95d4e5f9a \
                    sha1    988f6ec63e93e6ec23492fd39e3b48a58fd695d1 \
                    rmd160  1749032c16e7c5afaa79bc123db33d61acc79eba

patchfiles      patch-install.sh.diff

configure {
    copy -force ${worksrcpath}/makefile.macosx ${worksrcpath}/makefile.machine
}

post-configure {
    if {[variant_isset universal]} {
        reinplace "s|\$(LOCAL_FLAGS)|${configure.universal_cflags} \$(LOCAL_FLAGS)|g" \
            ${worksrcpath}/makefile.machine
    }
}

destroot.destdir    DEST_HOME=${prefix} \
                    DEST_SHARE_DOC=${prefix}/share/doc/${name}-${version} \
                    DEST_MAN=${prefix}/share/man \
                    DEST_DIR=${destroot}
